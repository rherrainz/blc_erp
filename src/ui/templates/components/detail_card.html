<div class="card bg-base-100 shadow-md p-6">
  <h2 class="text-xl font-bold mb-4">{{ title }}</h2>

  <div class="space-y-2">
    <p><strong>Razón Social:</strong> {{ entity.company_name|default:"—" }}</p>
    <p><strong>Nombre:</strong> {{ entity.name|default:"—" }}</p>
    <p><strong>Email:</strong> {{ entity.email|default:"—" }}</p>
    <p><strong>Teléfono:</strong> {{ entity.phone|default:"—" }}</p>
    <p><strong>Dirección:</strong> {{ entity.address|default:"—" }}</p>
    <p><strong>CUIT/CUIL:</strong> {{ entity.tax_id|default:"—" }}</p>
    <p><strong>Notas:</strong> {{ entity.notes|default:"—" }}</p>
    <p><strong>Activo:</strong> {{ entity.is_active|yesno:"Sí,No" }}</p>
  </div>

  <div class="mt-6 flex gap-4">
    <a href="{{ edit_url }}" class="btn btn-warning">Editar</a>

    {# ==== Cálculo robusto de variables para el modal ==== #}
    {% with idstr=entity.id|stringformat:"s" %}
      {% with mid=title|slugify|add:"-"|add:idstr %}
        {% firstof entity.company_name entity.name entity as item_label %}

        <button type="button"
                class="btn btn-error"
                onclick="document.getElementById('deleteModal-{{ mid }}').showModal()">
          Eliminar
        </button>

        {# Pasamos variables al contexto y hacemos include sin 'with' en línea #}
        {% with modal_id="deleteModal-"|add:mid action_url=delete_url item_label=item_label %}
          {% include "components/delete_modal.html" %}
        {% endwith %}

      {% endwith %}
    {% endwith %}
  </div>
</div>
